- desc: |-
    <b><a name="itmv1_Extended_Header_0x0">Attack type</a></b>
    - 0 ⟶ None
    - 1 ⟶ <b><a name="itmv1_Extended_Header_0x0_1">Melee</a></b>
    - 2 ⟶ <b><a name="itmv1_Extended_Header_0x0_2">Ranged</a></b>
    - 3 ⟶ <b><a name="itmv1_Extended_Header_0x0_3">Magical</a></b>
    - 4 ⟶ <b><a name="itmv1_Extended_Header_0x0_4">Launcher</a></b>

    For <code><a href="#itmv1_Extended_Header_0x2_3">Item</a></code> abilities:
    - Do NOT use `0|None`, will crash the game.
    - Only <code><a href="#itmv1_Extended_Header_0x0_3">Magical</a></code> abilities can be drained (along with <a href="../../opcodes/bgee.htm#op243">opcode #243</a>'s other restrictions).
    - Type <code><a href="#itmv1_Extended_Header_0x0_4">4</a></code> cannot be used except from scripts (icon won't show up in actionbar).

    For <code><a href="#itmv1_Extended_Header_0x2_1">Weapon</a></code> abilities:
    - Do NOT use `0|None`, will crash the game.
    - <code><a href="#itmv1_Extended_Header_0x0_1">Melee</a></code>: Ignores the <code><a href="#itmv1_Extended_Header_0x2A">projectile</a></code> field (always uses `#1|None`). Valid for Weapon Styles.
    - <code><a href="#itmv1_Extended_Header_0x0_2">Ranged</a></code>:
      - Utilizes <code><a href="#itmv1_Extended_Header_0x2A">projectile</a></code> field.
      - Item cannot be equipped in <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code>, unless its <code><a href="#Header_ItemType">itemtype</a></code> can only be equipped in the <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code> slot, from <code><a href="../../files/2da/2da_bgee/itemtype.htm">ITEMTYPE.2DA</a></code>.
      - If equipped in <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code>, it will attack as normal (at least for the offhand).
      - <code><a href="../../files/ids/bgee/slots.htm#9">Off-hand</a></code> weapon will be suppressed while this item ability is selected in <code><a href="../../files/ids/bgee/slots.htm#35">mainhand</a></code> (EE only).
    - <code><a href="#itmv1_Extended_Header_0x0_3">Magical</a></code>: Identical to `Type 1 (Melee)`, except that it can be drained.
    - <code><a href="#itmv1_Extended_Header_0x0_4">Launcher</a></code>:
      - In the <code><a href="../../files/ids/bgee/slots.htm#35">mainhand</a></code> slots:
        - Ability cannot actually be selected, nor is the item considered "equipped" by script triggers or <a href="../../opcodes/bgee.htm#op183">opcode #183</a>.
        - Equipped effects, stats and on-hit effects are added to the currently selected weapon ability IF that ability requires a <code><a href="#itmv1_Extended_Header_0x10">launcher</a></code> of this type.
      - In the <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code> slot:
        - Item cannot be equipped in <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code>, unless its <code><a href="#Header_ItemType">itemtype</a></code> can only be equipped in the <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code> slot, from <code><a href="../../files/2da/2da_bgee/itemtype.htm">ITEMTYPE.2DA</a></code>.
        - Attack cycle will stop when this weapon would have attacked (must be re-initiated manually or by script).
  type: char
- desc: |
    ID Req.
    - bit 0 ⟶ ID Required
    - bit 1 ⟶ Non-ID Required
  type: char
- desc: |-
    <b><a name="itmv1_Extended_Header_0x2">Location</a></b>

    - 0 ⟶ None
      - Ability will not be selectable through the UI (but still available to scripts and spell-casting opcodes).
    - 1 ⟶ <b><a name="itmv1_Extended_Header_0x2_1">Weapon</a></b>
      - Ability can be used/selected in Quick-weapon slots (when equipped in one of the <code><a href="../../files/ids/bgee/slots.htm#35">mainhand</a></code>/<code><a href="../../files/ids/bgee/slots.htm#11">ammo</a></code>/<code><a href="../../files/ids/bgee/slots.htm#10">fist</a></code>/<code><a href="../../files/ids/bgee/slots.htm#34">magical weapon</a></code> slots).
    - 2 ⟶ Spell
      - <code><a href="../ie_formats/spl_v1.htm#splv1_Extended_Header_0x2_2">SPL</a></code> only.
    - 3 ⟶ <b><a name="itmv1_Extended_Header_0x2_3">Equipment / Item</a></b>
      - Ability can be selected from Quick-item slots, when equipped in one of those slots, or from the "Use Item (F8)" button if equipped elsewhere (except the <code><a href="../../files/ids/bgee/slots.htm#34">Magical Weapon Slot</a></code>).
    - 4 ⟶ Innate
      - <code><a href="../ie_formats/spl_v1.htm#splv1_Extended_Header_0x2_4">SPL</a></code> only.
    - 5+ ⟶ As `0`.

    {% capture note %}
    The first ability header of an item equipped in a <code><a href="../../files/ids/bgee/slots.htm#35">weapon</a></code>/<code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code> slot will always be treated as a <code><a href="#itmv1_Extended_Header_0x2_1">weapon</a></code> abillty, even if it lacks the correct <code><a href="#itmv1_Extended_Header_0x2">location</a></code> to be selected as such, unless that item is a <code><a href="../../files/ids/bgee/itemcat.htm#12">shield</a></code> in the <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code>.
    {% endcapture %} {% include note.html %}
  type: char
- desc: Alternative dice sides
  type: char
- desc: Use icon
  type: resref
- desc: |-
    Target type

    - 0 ⟶ Invalid (cannot be selected)
    - 1 ⟶ <b><a name="itmv1_Extended_Header_0xC_1">Living actor</a></b>
      - Target Portrait, Creature/Actor, <a href="../ie_formats/are_v1.htm#formAREAV1_0_Container">Container</a>, or <a href="../ie_formats/are_v1.htm#formAREAV1_0_Door">Door</a>. Checks <code><a href="#itmv1_Extended_Header_0xE">range</a></code> range.
    - 2 ⟶ <b><a name="itmv1_Extended_Header_0xC_2">Inventory</a></b>
      - Can't be activated manually.
    - 3 ⟶ <b><a name="itmv1_Extended_Header_0xC_3">Dead actor</a></b>
      - As <code><a href="#itmv1_Extended_Header_0xC_1">Living Actor</a></code>. It really just ignores any <code><a href="#itmv1_Extended_Header_0xE">range</a></code> requirement, including being in the same area.
    - 4 ⟶ <b><a name="itmv1_Extended_Header_0xC_4">Any point within range</a></b>
      - Target location. Checks <code><a href="#itmv1_Extended_Header_0xE">range</a></code>.
    - 5 ⟶ <b><a name="itmv1_Extended_Header_0xC_5">Caster</a></b>
      - Targets Self.
    - 6 ⟶ Crash
      - Can't be activated manually.
    - 7 ⟶ <b><a name="itmv1_Extended_Header_0xC_7">Caster</a></b> (EE only)
      - Targets Self. In particular:
        - Cast instantly (even while the game is paused).
        - Ignores one item per round rule.
        - Ignores <code><a href="#itmv1_Extended_Header_0x2A">projectile</a></code> (uses `#1|None`).

    {% capture note %}
    - This field matter doesn't matter when the ability is activated/cast by script, when cast by another opcode, or for weapon attacks.
    - <code><a href="#itmv1_Extended_Header_0x2_1">Weapon</a></code> attacks always use a more restricted form of <code><a href="#itmv1_Extended_Header_0xC_1">Living actor</a></code>, as they cannot target <a href="../ie_formats/are_v1.htm#formAREAV1_0_Container">containers</a> or <a href="../ie_formats/are_v1.htm#formAREAV1_0_Door">doors</a> unless they are locked.
    {% endcapture %} {% include note.html %}
  type: char
- desc: |-
    Target count

    - Only usable by <code><a href="#itmv1_Extended_Header_0x2_3">Item</a></code> abilities, and only with Ability Targets <code><a href="#itmv1_Extended_Header_0xC_1">1</a></code>, <code><a href="#itmv1_Extended_Header_0xC_3">3</a></code>, or <code><a href="#itmv1_Extended_Header_0xC_4">4</a></code>.
    - Targeting reticle will display amount remaining while selecting targets.
    - Double-clicking a target/location will target it for the remaining amount.
    - Regardless of the number of targets, only a single "Charge"/"Memorization" will be expended.
    - This feature cannot be utilized by scripts.
  type: char
- desc: <b><a name="itmv1_Extended_Header_0xE">Range</a></b>
  type: word
- desc: |-
    <b><a name="itmv1_Extended_Header_0x10">Launcher required</a></b>

    - 0 ⟶ None
    - 1 ⟶ Bow
      - Any <code><a href="#itmv1_Extended_Header_0x0_2">Ranged</a></code> ability with this field set to this value will require a weapon with the corresponding <code><a href="../../files/ids/bgee/itemcat.htm#15">ITEMCAT.IDS</a></code> (Item category) in one of the <code><a href="../../files/ids/bgee/slots.htm#35">mainhand</a></code> weapon slots (not <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code>, <code><a href="../../files/ids/bgee/slots.htm#10">fist</a></code>, or <code><a href="../../files/ids/bgee/slots.htm#34">magical weapon</a></code> slot).
    - 2 ⟶ Crossbow
      - Any <code><a href="#itmv1_Extended_Header_0x0_2">Ranged</a></code> ability with this field set to this value will require a weapon with the corresponding <code><a href="../../files/ids/bgee/itemcat.htm#27">ITEMCAT.IDS</a></code> (Item category) in one of the <code><a href="../../files/ids/bgee/slots.htm#35">mainhand</a></code> weapon slots (not <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code>, <code><a href="../../files/ids/bgee/slots.htm#10">fist</a></code>, or <code><a href="../../files/ids/bgee/slots.htm#34">magical weapon</a></code> slot).
    - 3 ⟶ Sling
      - Any <code><a href="#itmv1_Extended_Header_0x0_2">Ranged</a></code> ability with this field set to this value will require a weapon with the corresponding <code><a href="../../files/ids/bgee/itemcat.htm#18">ITEMCAT.IDS</a></code> (Item category) in one of the <code><a href="../../files/ids/bgee/slots.htm#35">mainhand</a></code> weapon slots (not <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code>, <code><a href="../../files/ids/bgee/slots.htm#10">fist</a></code>, or <code><a href="../../files/ids/bgee/slots.htm#34">magical weapon</a></code> slot).
    - 40 ⟶ Spear
    - 100 ⟶ Throwing Axe

    In particular:
    - It ONLY checks items for <code><a href="../../files/ids/bgee/itemcat.htm#15">BOW</a></code> / <code><a href="../../files/ids/bgee/itemcat.htm#27">XBOW</a></code> / <code><a href="../../files/ids/bgee/itemcat.htm#18">SLING</a></code> and will always use that item's first ability header – it doesn't matter what that ability's <code><a href="#itmv1_Extended_Header_0x0">Type</a></code> is (`Melee/Ranged/Magical/Launcher`).
    - <code><a href="../../files/ids/bgee/itemcat.htm">ITEMCAT</a></code> is offset <code><a href="#Header_ItemType">0x1C</a></code> of the ITM file (which is also linked to <code><a href="../../files/2da/2da_bgee/itemtype.htm">ITEMTYPE.2DA</a></code>).
    - Only the <code><a href="../../files/ids/bgee/slots.htm#35">Mainhand</a></code>, <code><a href="../../files/ids/bgee/slots.htm#11">Ammo</a></code>, and <code><a href="../../files/ids/bgee/slots.htm#34">Magical Weapon</a></code> slots can utilize launchers. The <code><a href="../../files/ids/bgee/slots.htm#9">off-hand</a></code> ignores this field, while the <code><a href="../../files/ids/bgee/slots.htm#10">fist</a></code> slot uses it (only to crash).
    - Weapons of any <code><a href="../../files/ids/bgee/itemcat.htm">ITEMCAT</a></code> can use this field, as long as it is equipped in one of the proper slots.
    - Bows, Crossbows, and Slings with multiple abilities can even use themselves as their required launcher.
  type: byte
- desc: Alternative dice thrown
  type: byte
- desc: Speed
  type: byte
- desc: Alternative damage bonus
  type: byte
- desc: |
    THAC0 bonus

    A successful hit will always occur if any of the conditions below is true
    - This field is set to `32767`
    - The target creature(s) is STATE_HELPLESS
    - The target is affected by time stop
  type: word
- desc: Dice sides
  type: byte
- desc: |-
    <b><a name="itmv1_Extended_Header_0x17">Primary Type</a></b>
  type: byte
- desc: Dice thrown
  type: byte
- desc: |-
    <b><a name="itmv1_Extended_Header_0x19">Secondary Type</a></b>
  type: byte
- desc: Damage bonus
  type: word
- desc: |-
    Damage type
    - 0 ⟶ None
    - 1 ⟶ Piercing/Magic
    - 2 ⟶ Blunt
    - 3 ⟶ Slashing
    - 4 ⟶ Ranged
    - 5 ⟶ Fists
    - 6 ⟶ Piercing/Blunt (more) (BG2)
    - 7 ⟶ Piercing/Slashing (more) (BG2)
    - 8 ⟶ Blunt/Slashing (less) (BG2)
  type: word
- desc: Count of feature blocks
  type: word
- desc: Index into feature blocks
  type: word
- desc: Charges
  type: word
- desc: |-
    <b><a name="itmv1_Extended_Header_0x24">Charge depletion behaviour</a></b>
    - 0 ⟶ Don't vanish
    - 1 ⟶ Expended
    - 2 ⟶ Expended (w/o sound)
    - 3 ⟶ Recharge each day
  type: word
- desc: '[Flags](#ExtHeader_Flags)'
  type: dword
- desc: |-
    <b><a name="itmv1_Extended_Header_0x2A">Projectile Animation</a></b> (projectl.ids/missile.ids)
  type: word
- desc: |-
    <b>[Melee animation](#ExtendedHeader_MeleeAnimation)</b>

    - It should total 100, but not mandatory on EE games.
    - Not needed if <code><a href="#itmv1_Extended_Header_0x32">Arrow</a></code>/<code><a href="#itmv1_Extended_Header_0x34">Bolt</a></code>/<code><a href="#itmv1_Extended_Header_0x36">Bullet</a></code> is used.
    - It should work as such:
      - Engine rolls `0 – 99`.
      - `overhand range = 0 to (overhand - 1)`
      - `backhand range = overhand to (overhand + backhand - 1)`
      - `thrust range = (overhand + backhand) to (overhand + backhand + thrust - 1)`
    - Along with <code><a href="#itmv1_Extended_Header_0x32">Is arrow?</a></code>/<code><a href="#itmv1_Extended_Header_0x34">Is bolt?</a></code>/<code><a href="#itmv1_Extended_Header_0x36">Is bullet?</a></code>, it is only used for attack animations. If all are zero, no animation will be used for attacking. Activated <code><a href="#itmv1_Extended_Header_0x2_3">Item</a></code> abilities can leave them all `0`, as they are not used.
  type: word
  mult: 3
- desc: |-
    <b><a name="itmv1_Extended_Header_0x32">Arrow qualifier / Is arrow?</a></b>
    - 0 ⟶ No
    - 1 ⟶ Yes

    It control which firing animation the ability will use.
    It needs to be set on any launcher and/or ammo, but the launcher will override the ammo.
  type: word
- desc: |-
    <b><a name="itmv1_Extended_Header_0x34">Bolt qualifier / Is bolt?</a></b>
    - 0 ⟶ No
    - 1 ⟶ Yes

    It control which firing animation the ability will use.
    It needs to be set on any launcher and/or ammo, but the launcher will override the ammo.
  type: word
- desc: |-
    <b><a name="itmv1_Extended_Header_0x36">Bullet qualifier / Is bullet?</a></b>
    - 0 ⟶ No
    - 1 ⟶ Yes

    It control which firing animation the ability will use.
    It needs to be set on any launcher and/or ammo, but the launcher will override the ammo.
  type: word
  offset: 0x36
