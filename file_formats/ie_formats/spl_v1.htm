<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<!--  <meta charset="utf-8"> -->
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SPL file format</title>
  <meta name="description" content="The IESDP (Infinity Engine Structures Description Project) is an effort to research the workings of the Bioware Infinity Engine(R), and act as a collective resource for those interested in such workings.
">

  





  <link rel="stylesheet" href="../../css/main.css">

<!--
  <link rel="canonical" href="https://gibberlings3.github.io/iesdp/file_formats/ie_formats/spl_v1.htm">
  <link rel="alternate" type="application/rss+xml" title="IESDP" href="https://gibberlings3.github.io/iesdp/feed.xml">
-->
</head>


<body>

<header class="site-header">








    <hr />
    <div id="buttonboxtop">
      <div id="buttonstriptop">
        <a href="../../index.htm">Index</a> &nbsp;&bull;&nbsp;
        <a href="../../files/2da/index.htm">2DA</a> &nbsp;&bull;&nbsp;
        <a href="../../opcodes/index.htm">Effects</a> &nbsp;&bull;&nbsp;
        <a href="../../file_formats/index.htm">File Formats</a> &nbsp;&bull;&nbsp;
        <a href="../../scripting/actions/index.htm">Actions</a> &nbsp;&bull;&nbsp;
        <a href="../../files/ids/index.htm">Identifiers</a> &nbsp;&bull;&nbsp;
        <a href="../../scripting/triggers/index.htm">Triggers</a> &nbsp;&bull;&nbsp;
        <a href="../../appendices/index.htm">Appendices</a> &nbsp;&bull;&nbsp;
        <a href="../../site_info/index.htm">Site Info</a> &nbsp;&bull;&nbsp;
        <a href="../../site_info/legal.htm">Legal</a> &nbsp;&bull;&nbsp;
        <a href="https://www.gibberlings3.net/forums/forum/54-iesdp-updates-and-info/" target="_blank">Forum</a>
      </div>
    </div>
    <hr />
    <div id="logo">
      <a href="../../main.htm">
        <img src="../../images/iesdp_logo.gif" alt="IESDP Logo" width="120" height="120" />
      </a>
    </div>

</header>


<div id="nonFooter">
  <div id="content">

    <div class="title_main">SPL file format</div>
    <br />
    <div class="fileHeader">Applies to:</div>
    <div class="indent1">BG1, BG1: TotS, BG2, BG2: ToB, PST, IWD, IWD:HoW, IWD:TotL, BGEE</div>
    <br />
    
    <div class="fileHeader">General Description</div>
    <div class="indent1">
      This file format describes a "spell". Spells include mage spells, priest spells, innate abilities, special abilities and effects used for game advancement (e.g. animation effects, custom spells). SPL files have a similar structure to <a href="itm_v1.htm">ITM </a>files.<br />
    </div>
    <br />
    
    <div class="center"><img border="0" src="../../images/spl.gif"></div>
    <table align="center">
      <tr>
        <td><img src="../../images/red.jpg" width="10" height="10"></td>
        <td><strong>Header:</strong>Size=114 Bytes</td>
        <td><img src="../../images/blue.jpg" width="10" height="10"></td>
        <td><strong>Ext. Header:</strong> Size= 40 Bytes</td>
        <td><img src="../../images/green.jpg" width="10" height="10"></td>
        <td><strong>Feature Block:</strong> Size=48 Bytes</td>
      </table>
    <br />
    
    <div class="fileHeader">Detailed Description</div>
    <div class="indent1">
      SPL files consist of a main header, zero or more extended headers (each containing zero or more feature blocks) and zero or more casting feature blocks. All the feature blocks are stored as a continuous data segment, with each extended header containing an offset into this data, and the main header containing an offset into this data for the casting feature blocks.<br />
      <br />
      Overall structure:<br />
      <div class="indent1">
        <li>
          <a href="#splv1_Header">Header</a>
        <li>
          <a href="#splv1_Extended_Header">Extended Headers</a>
        <li>
           <a href="#splv1_Feature_Block">Feature Blocks</a>
      </div>
      <br />
    </div>
    
    
    
    
    <div class="fileHeader">
  <a name="splv1_Header">Header</a>
</div>
<br />
<div class="indent1">
  
  <table border="1" width="98%" class="offset_table">
    <colgroup>
      <col width="5%" />
      <col width="12%" />
      <col width="*" />
    </colgroup>
    <thead>
      <tr>
        <th>Offset</th>
        <th>Size (datatype)</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      



<tr>










  <td>0x0000</td>
  <td>4 (char array)</td>
  <td><p>Signature (‘SPL  ’)</p>
</td>
</tr>



<tr>










  <td>0x0004</td>
  <td>4 (char array)</td>
  <td><p>Version (‘V1  ‘)</p>
</td>
</tr>



<tr>










  <td>0x0008</td>
  <td>4 (dword)</td>
  <td><p><b><a name="splv1_Header_0x8">Spell Name</a></b> - Unidentified (strref)</p>
</td>
</tr>



<tr>










  <td>0x000c</td>
  <td>4 (dword)</td>
  <td><p><span class="unknown">Spell Name - Identified (strref) (usually <code class="language-plaintext highlighter-rouge">-1</code>) (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0010</td>
  <td>8 (resref)</td>
  <td><p>Completion Sound</p>
</td>
</tr>



<tr>










  <td>0x0018</td>
  <td>4 (dword)</td>
  <td><p><a href="#Header_Flags">Flags</a></p>
</td>
</tr>



<tr>










  <td>0x001c</td>
  <td>2 (word)</td>
  <td><p><b><a name="splv1_Header_0x1C">Spell type</a></b>:</p>

<ul>
  <li>0 ⟶ <b><a name="splv1_Header_0x1C_0">Special</a></b></li>
  <li>1 ⟶ <b><a name="splv1_Header_0x1C_1">Wizard</a></b></li>
  <li>2 ⟶ <b><a name="splv1_Header_0x1C_2">Priest</a></b></li>
  <li>3 ⟶ <b><a name="splv1_Header_0x1C_3">Psionic</a></b></li>
  <li>4 ⟶ <b><a name="splv1_Header_0x1C_4">Innate</a></b></li>
  <li>5 ⟶ <b><a name="splv1_Header_0x1C_5">Bard song</a></b></li>
</ul>

<div class="note info">
  <div>
    <strong>Info:</strong> 
<ul>
  <li><code><a href="#splv1_Header_0x1C_0">Special</a></code>, <code><a href="#splv1_Header_0x1C_3">Psionic</a></code>, <code><a href="#splv1_Header_0x1C_4">Innate</a></code>, and <code><a href="#splv1_Header_0x1C_5">Bard song</a></code> differ only by the string displayed when you cast them. They are all treated as <code><a href="#splv1_Header_0x1C_4">Innate</a></code> abilities, even by <a href="../../opcodes/bgee.htm#op145">opcode #145</a> and the <code><a href="../../scripting/triggers/bgeetriggers.htm#0x00A7">SpellCastInnate()</a></code> trigger.</li>
  <li><code><a href="#splv1_Header_0x1C_0">Special</a></code> and <code><a href="#splv1_Header_0x1C_4">Innate</a></code> will display <code>"(Caster): (<a href="#splv1_Header_0x8">spell name</a>): (target)"</code>.</li>
  <li><code><a href="#splv1_Header_0x1C_3">Psionic</a></code> and <code><a href="#splv1_Header_0x1C_5">Bard song</a></code> will display <code>"(Caster): Casts (<a href="#splv1_Header_0x8">spell name</a>): (target)"</code> (which can be misleading).</li>
  <li><code><a href="#splv1_Header_0x1C_1">Wizard</a></code> and <code><a href="#splv1_Header_0x1C_2">Priest</a></code> will also display <code>"(Caster): Casts (<a href="#splv1_Header_0x8">spell name</a>): (target)"</code>.</li>
  <li>Any spell cast by one of the <code><a href="../../scripting/actions/bgeeactions.htm#113">ForceSpell()</a></code> script actions will instead display <code><a href="#splv1_Header_0x1C_0">Special</a></code>/<code><a href="#splv1_Header_0x1C_4">Innate</a></code> casting message.</li>
  <li>Any spell cast by the “BattleSong” (Bard Song/Shaman Dance) or <code><a href="../../scripting/actions/bgeeactions.htm#160">ApplySpell()</a></code> script actions will display <code><a href="#splv1_Header_0x1C_0">Special</a></code>/<code><a href="#splv1_Header_0x1C_4">Innate</a></code> casting message.</li>
  <li>For any spell cast by another opcode, its casting message will depend on that opcode, but is usually the same as the <code><a href="#splv1_Header_0x1C_0">Special</a></code>/<code><a href="#splv1_Header_0x1C_4">Innate</a></code> casting message.</li>
  <li>All other values (<code class="language-plaintext highlighter-rouge">6 – 65535</code>) functions the same as <code><a href="#splv1_Header_0x1C_3">Psionic</a></code>/<code><a href="#splv1_Header_0x1C_5">Bard song</a></code>.</li>
  <li><code><a href="../../files/ids/bgee/stats.htm#51">SPELLFAILUREMAGE</a></code> is related to Spell type <code><a href="#splv1_Header_0x1C_1">Wizard</a></code>.</li>
  <li><code><a href="../../files/ids/bgee/stats.htm#52">SPELLFAILUREPRIEST</a></code> is related to Spell type <code><a href="#splv1_Header_0x1C_2">Priest</a></code>.</li>
  <li><code><a href="../../files/ids/bgee/stats.htm#194">SPELL_FAILURE_INNATE</a></code> is related to Spell type <code><a href="#splv1_Header_0x1C_3">Psionic</a></code>/<code><a href="#splv1_Header_0x1C_4">Innate</a></code>/<code><a href="#splv1_Header_0x1C_5">Bard song</a></code>.</li>
  <li>Normally, any subspells that scale with <code><a href="#splv1_Extended_Header_0x10">Level</a></code> should be of the same <code><a href="#splv1_Header_0x1C">Type</a></code> as the spell casting them.
    <ul>
      <li>If they don’t scale, it doesn’t really matter.</li>
      <li>It also doesn’t matter when they are applied through <a href="../../opcodes/bgee.htm#op146">opcode #146</a><code><sup><small>*</small></sup>p2=2</code>/<a href="../../opcodes/bgee.htm#op326">opcode #326</a>/<a href="../../opcodes/bgee.htm#op333">opcode #333</a>.</li>
    </ul>
  </li>
</ul>

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x001e</td>
  <td>4 (dword)</td>
  <td><p><a href="#Exclusion_Flags">Exclusion Flags</a></p>
</td>
</tr>



<tr>










  <td>0x0022</td>
  <td>2 (word)</td>
  <td><p><a href="#Header_Casting_Graphics">Casting Graphics</a></p>
</td>
</tr>



<tr>










  <td>0x0024</td>
  <td>1 (char)</td>
  <td><p><span class="unknown">Min Level (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0025</td>
  <td>1 (byte)</td>
  <td><p><b><a name="splv1_Header_0x25">Primary Type (School)</a></b> (IWD: school.2da, BG2:mschool.2da)</p>

<div class="note info">
  <div>
    <strong>Info:</strong> 
For subspells, <code><a href="#splv1_Header_0x25">Primary Type</a></code> should always match parent spell, both for interaction with opcodes <a href="../../opcodes/bgee.htm#op220">#220</a>/<a href="../../opcodes/bgee.htm#op229">#229</a>, and with the specialists save bonus/penalty (and <a href="../../opcodes/bgee.htm#op346">opcode #346</a>).

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0026</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Min Strength (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0027</td>
  <td>1 (char)</td>
  <td><p><b><a name="splv1_Header_0x27">Secondary Type</a></b> (BG2:msectype.2da)</p>

<div class="note info">
  <div>
    <strong>Info:</strong> 
For subspells, <code><a href="#splv1_Header_0x27">Secondary Type</a></code> should always match parent spell, for interaction with opcodes <a href="../../opcodes/bgee.htm#op221">#221</a>/<a href="../../opcodes/bgee.htm#op230">#230</a>.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0028</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Min Strength Bonus (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0029</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Usability 1 (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x002a</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Min Int (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x002b</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Usability 2 (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x002c</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Min Dex (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x002d</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Usability 3 (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x002e</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Min Wis (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x002f</td>
  <td>1 (byte)</td>
  <td><p><span class="unknown">Usability 4 (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0030</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Min Con (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0032</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Min Cha (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0034</td>
  <td>4 (dword)</td>
  <td><p><b><a name="splv1_Header_0x34">Spell Level</a></b></p>

<ul>
  <li>There is no good reason for a <code><a href="#splv1_Header_0x1C_0">Special</a></code>/<code><a href="#splv1_Header_0x1C_3">Psionic</a></code>/<code><a href="#splv1_Header_0x1C_4">Innate</a></code>/<code><a href="#splv1_Header_0x1C_5">Bard song</a></code> to be any <code><a href="#splv1_Header_0x34">Spell level</a></code> except <code class="language-plaintext highlighter-rouge">1</code>.</li>
  <li>If the SPL is never <a href="../../opcodes/bgee.htm#op147">learned</a>/<a href="../../opcodes/bgee.htm#op171">gained</a> (only force-cast by script/opcode), <code><a href="#splv1_Header_0x34">Spell level</a></code> doesn’t matter, but there may be some niche cases that check it (f.i. <code><a href="../../scripting/triggers/bgeetriggers.htm#0x4031">HaveSpell()</a></code>).</li>
</ul>
</td>
</tr>



<tr>










  <td>0x0038</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Stack amount (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x003a</td>
  <td>8 (resref)</td>
  <td><p>Spellbook icon (BAM). The engine replaces the last character of this filename with a C.</p>
</td>
</tr>



<tr>










  <td>0x0042</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Lore to ID (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0044</td>
  <td>8 (resref)</td>
  <td><p><span class="unknown">Ground icon (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x004c</td>
  <td>4 (dword)</td>
  <td><p><span class="unknown">Weight (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0050</td>
  <td>4 (dword)</td>
  <td><p>Spell Description - Unidentified (strref)</p>
</td>
</tr>



<tr>










  <td>0x0054</td>
  <td>4 (dword)</td>
  <td><p><span class="unknown">Spell Description - Identified (strref) (usually <code class="language-plaintext highlighter-rouge">-1</code>) (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0058</td>
  <td>8 (resref)</td>
  <td><p><span class="unknown">Description icon (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0060</td>
  <td>4 (dword)</td>
  <td><p><span class="unknown">Enchantment (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0064</td>
  <td>4 (dword)</td>
  <td><p>Extended Header offset</p>
</td>
</tr>



<tr>










  <td>0x0068</td>
  <td>2 (word)</td>
  <td><p>Extended Header count</p>
</td>
</tr>



<tr>










  <td>0x006a</td>
  <td>4 (dword)</td>
  <td><p>Feature Block Table offset</p>
</td>
</tr>



<tr>










  <td>0x006e</td>
  <td>2 (word)</td>
  <td><p>Casting Feature Block offset (these feature blocks may not use target type 2)</p>
</td>
</tr>



<tr>










  <td>0x0070</td>
  <td>2 (word)</td>
  <td><p>Casting Feature Block count</p>
</td>
</tr>




    </tbody>
  </table>
</div>
<br />


    
    
    
    
    <div class="fileHeader">
  <a name="splv1_Extended_Header">Extended Header</a>
</div>
<br />
<div class="indent1">
  
    Extended headers represent the effects of a spell on the target. Multiple extended headers can be set in a spell, to allow the spell to use effects based on the level of the caster. Extended headers should be in the file in order of increasing level<br /><br />
    
  
  <table border="1" width="98%" class="offset_table">
    <colgroup>
      <col width="5%" />
      <col width="12%" />
      <col width="*" />
    </colgroup>
    <thead>
      <tr>
        <th>Offset</th>
        <th>Size (datatype)</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      



<tr>










  <td>0x0000</td>
  <td>1 (char)</td>
  <td><p>Spell form</p>
<ul>
  <li>1 - Standard</li>
  <li>2 - Projectile</li>
</ul>

<div class="note info">
  <div>
    <strong>Note:</strong> 
This field matters only for <code><a href="../ie_formats/itm_v1.htm#itmv1_Extended_Header_0x0">ITM</a></code>, SPL files shouldn’t function any different based on their type (even <code class="language-plaintext highlighter-rouge">0</code>).

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0001</td>
  <td>1 (char)</td>
  <td><ul>
  <li>bit 2: ‘Friendly’ ability</li>
</ul>
</td>
</tr>



<tr>










  <td>0x0002</td>
  <td>2 (word)</td>
  <td><p><b><a name="splv1_Extended_Header_0x2">Location</a></b></p>

<ul>
  <li>0 ⟶ None
    <ul>
      <li>Ability will not be selectable through the UI (but still available to scripts and spell-casting opcodes).</li>
    </ul>
  </li>
  <li>1 ⟶ Weapon
    <ul>
      <li><code><a href="../ie_formats/itm_v1.htm#itmv1_Extended_Header_0x2_1">ITM</a></code> only.</li>
    </ul>
  </li>
  <li>2 ⟶ <b><a name="splv1_Extended_Header_0x2_2">Spell</a></b>
    <ul>
      <li>Ability can be selected from “Cast Spell (F7)” button, and from Quick-spell buttons.</li>
    </ul>
  </li>
  <li>3 ⟶ Item
    <ul>
      <li><code><a href="../ie_formats/itm_v1.htm#itmv1_Extended_Header_0x2_3">ITM</a></code> only.</li>
    </ul>
  </li>
  <li>4 ⟶ <b><a name="splv1_Extended_Header_0x2_4">Innate</a></b>
    <ul>
      <li>Ability can be selected from “Special Abilities (F12)” button.</li>
    </ul>
  </li>
  <li>5+ ⟶ As <code class="language-plaintext highlighter-rouge">0</code>.</li>
</ul>

<div class="note info">
  <div>
    <strong>Note:</strong> 
Subspells don’t require an <code><a href="#splv1_Extended_Header_0x2">Ability Location</a></code>.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0004</td>
  <td>8 (resref)</td>
  <td><p>Memorised icon (BAM). The engine replaces the last character of this filename with a B.</p>
</td>
</tr>



<tr>










  <td>0x000c</td>
  <td>1 (char)</td>
  <td><p><b><a name="splv1_Extended_Header_0xC">Target</a></b></p>

<ul>
  <li>0 ⟶ Invalid (cannot be selected)</li>
  <li>1 ⟶ <b><a name="splv1_Extended_Header_0xC_1">Living actor</a></b>
    <ul>
      <li>Targets Portrait, <a href="../ie_formats/are_v1.htm#formAREAV1_0_Actor">Creature/Actor</a>, <a href="../ie_formats/are_v1.htm#formAREAV1_0_Container">Container</a>, or <a href="../ie_formats/are_v1.htm#formAREAV1_0_Door">Door</a>. Checks <code><a href="#splv1_Extended_Header_0xE">Range</a></code>.</li>
    </ul>
  </li>
  <li>2 ⟶ <b><a name="splv1_Extended_Header_0xC_2">Inventory</a></b>
    <ul>
      <li>Can’t be activated manually.</li>
    </ul>
  </li>
  <li>3 ⟶ <b><a name="splv1_Extended_Header_0xC_3">Dead actor</a></b>
    <ul>
      <li>As <code><a href="#splv1_Extended_Header_0xC_1">Living Actor</a></code>. It really just ignores any <code><a href="#splv1_Extended_Header_0xE">Range</a></code> requirement, including being in the same area.</li>
    </ul>
  </li>
  <li>4 ⟶ <b><a name="splv1_Extended_Header_0xC_4">Any point within range</a></b>
    <ul>
      <li>Targets location. Checks <code><a href="#splv1_Extended_Header_0xE">Range</a></code>.</li>
    </ul>
  </li>
  <li>5 ⟶ <b><a name="splv1_Extended_Header_0xC_5">Caster</a></b>
    <ul>
      <li>Targets Self.</li>
    </ul>
  </li>
  <li>6 ⟶ Crash
    <ul>
      <li>Can’t be activated manually.</li>
    </ul>
  </li>
  <li>7 ⟶ <b><a name="splv1_Extended_Header_0xC_7">Caster</a></b>
    <ul>
      <li>Targets Self. In particular:
        <ul>
          <li>Cast instantly (even while the game is paused).</li>
          <li>Ignores one spell per round rule.</li>
          <li>Ignores <a href="../../opcodes/bgee.htm#op38">Silence</a>, <a href="../../opcodes/bgee.htm#op60">Spell Failure</a>, <a href="../../opcodes/bgee.htm#op60">Dead Magic</a>, <a href="../../opcodes/bgee.htm#op280">Wild Surge</a>, <code><a href="#Header_Flags_BIT13">Outdoors Only</a></code>, <code><a href="#Header_Flags_BIT16">Non-combat</a></code>, probably a few other rules.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<div class="note info">
  <div>
    <strong>Note:</strong> 
<ul>
  <li>This field doesn’t matter when the ability is activated/cast by script or when cast by another opcode.</li>
  <li>Subspells don’t require an <code><a href="#splv1_Extended_Header_0xC">Ability Target</a></code>.</li>
</ul>

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x000d</td>
  <td>1 (char)</td>
  <td><p><b><a name="splv1_Extended_Header_0xD">Target count</a></b></p>

<ul>
  <li>Only usable with Ability Targets <code><a href="#splv1_Extended_Header_0xC_1">1</a></code>, <code><a href="#splv1_Extended_Header_0xC_3">3</a></code>, or <code><a href="#splv1_Extended_Header_0xC_4">4</a></code>.</li>
  <li>Targeting reticle will display amount remaining while selecting targets.</li>
  <li>Double-clicking a target/location will target it for the remaining amount.</li>
  <li>Regardless of the number of targets, only a single “Memorization” will be expended.</li>
  <li>This feature cannot be utilized by scripts.
    <ul>
      <li>Scripts will treat this field as if it’s always <code class="language-plaintext highlighter-rouge">1</code>.</li>
    </ul>
  </li>
</ul>
</td>
</tr>



<tr>










  <td>0x000e</td>
  <td>2 (word)</td>
  <td><p><b><a name="splv1_Extended_Header_0xE">Range</a></b></p>

<div class="note info">
  <div>
    <strong>Info:</strong> 
As far as subspells are concerned, their <code><a href="#splv1_Extended_Header_0xE">Range</a></code> is only checked if cast through <a href="../../opcodes/bgee.htm#op148">opcode #148</a>, <a href="../../opcodes/bgee.htm#op232">opcode #232</a>, <a href="../../opcodes/bgee.htm#op258">opcode #258</a>, or <a href="../../opcodes/bgee.htm#op260">opcode #260</a>.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0010</td>
  <td>2 (word)</td>
  <td><p><b><a name="splv1_Extended_Header_0x10">Level Required</a></b></p>

<div class="note info">
  <div>
    <strong>Info:</strong> 
Standard spellcasting only utilizes the first byte (<code class="language-plaintext highlighter-rouge">0 – 255</code>), but opcodes that specify Casting Level (<code><a href="../../opcodes/bgee.htm#op146">146</a><sup><small>*</small></sup>p2=2</code>/<code><a href="../../opcodes/bgee.htm#op326">326</a><sup><small>*</small></sup><a href="../ie_formats/eff_v2.htm#effv2_Body_0xC8">EFF</a></code>/<code><a href="../../opcodes/bgee.htm#op333">333</a></code>) have access to the entire range (<code class="language-plaintext highlighter-rouge">0 – 65535</code>).

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0012</td>
  <td>2 (word)</td>
  <td><p><b><a name="splv1_Extended_Header_0x12">Casting Time</a></b></p>

<div class="note info">
  <div>
    <strong>Info:</strong> 
<ul>
  <li>This value represents the number of tenths of rounds that it takes to cast the spell.</li>
  <li>Combat scripting in the IE gets very dumb when <code><a href="#splv1_Extended_Header_0x12">Casting Time</a></code>s start matching or exceeding <code class="language-plaintext highlighter-rouge">10</code> (one full round). The engine assumes any spell is cast within a round, and can sometimes just go to the next round’s action (f.i. the mage sits there casting for six seconds, then throws the spell away to use a sling).
    <ul>
      <li>As a result, you might want to use maximum <code><a href="#splv1_Extended_Header_0x12">Casting Time</a></code>s of <code class="language-plaintext highlighter-rouge">9</code> (i.e. <sup><small>9</small></sup>⁄<sub><small>10</small></sub>ths of a round) even for spells which are supposed to have a <code><a href="#splv1_Extended_Header_0x12">Casting Time</a></code> of a full round.</li>
    </ul>
  </li>
  <li>As far as subspells are concerned, their speed is only used if cast through <a href="../../opcodes/bgee.htm#op146">opcode #146</a>/<a href="../../opcodes/bgee.htm#op148">opcode #148</a> with the <code class="language-plaintext highlighter-rouge">Cast normally</code> option.</li>
</ul>

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0014</td>
  <td>2 (word)</td>
  <td><p>Times per day</p>
</td>
</tr>



<tr>










  <td>0x0016</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Dice Sides (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0018</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Dice Thrown (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x001a</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Enchanted (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x001c</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Damage Type (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x001e</td>
  <td>2 (word)</td>
  <td><p>Count of feature blocks</p>
</td>
</tr>



<tr>










  <td>0x0020</td>
  <td>2 (word)</td>
  <td><p>Offset to feature blocks</p>
</td>
</tr>



<tr>










  <td>0x0022</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Charges (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0024</td>
  <td>2 (word)</td>
  <td><p><span class="unknown">Charge depletion behaviour (unused)</span></p>
</td>
</tr>



<tr>










  <td>0x0026</td>
  <td>2 (word)</td>
  <td><p><b><a name="splv1_Extended_Header_0x26">Projectile</a></b> (BG2: <a href="../../ids/bg2/projectl.htm">projectl.ids</a>. <strong>Note:</strong> in BG2, this value is off-by-one from projectl.ids value. I.e. binary value of <code class="language-plaintext highlighter-rouge">2</code> corresponds to <code class="language-plaintext highlighter-rouge">0x1 - ARROW</code>)</p>
</td>
</tr>




    </tbody>
  </table>
</div>
<br />


    
    
    
    
    <div class="fileHeader">
  <a name="splv1_Feature_Block">Feature Block</a>
</div>
<br />
<div class="indent1">
  
    Any action carried out by a spell is done by feature blocks, each of which holds an effect number as well as targetting and timing information. The engine appears to roll a probability for each valid target type, rather than one probability per attack.<br /><br />
    
  
  <table border="1" width="98%" class="offset_table">
    <colgroup>
      <col width="5%" />
      <col width="12%" />
      <col width="*" />
    </colgroup>
    <thead>
      <tr>
        <th>Offset</th>
        <th>Size (datatype)</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      



<tr>










  <td>0x0000</td>
  <td>2 (word)</td>
  <td><p>Opcode Number</p>
</td>
</tr>



<tr>










  <td>0x0002</td>
  <td>1 (char)</td>
  <td><p><b><a name="V1_Feature_Block_0x2">Target type</a></b></p>

<ul>
  <li>0 ⟶ None</li>
  <li>1 ⟶ <b><a name="V1_Feature_Block_0x2_1">Self</a></b></li>
  <li>2 ⟶ <b><a name="V1_Feature_Block_0x2_2">Projectile target</a></b></li>
  <li>3 ⟶ <b><a name="V1_Feature_Block_0x2_3">Party</a></b></li>
  <li>4 ⟶ <b><a name="V1_Feature_Block_0x2_4">Everyone</a></b></li>
  <li>5 ⟶ <b><a name="V1_Feature_Block_0x2_5">Everyone except party</a></b></li>
  <li>6 ⟶ <b><a name="V1_Feature_Block_0x2_6">Caster group</a></b></li>
  <li>7 ⟶ <b><a name="V1_Feature_Block_0x2_7">Target group</a></b></li>
  <li>8 ⟶ <b><a name="V1_Feature_Block_0x2_8">Everyone except self</a></b></li>
  <li>9 ⟶ <b><a name="V1_Feature_Block_0x2_9">Original caster</a></b></li>
</ul>

<div class="note info">
  <div>
    <strong>Info:</strong> 
See <a href="../ie_formats/eff_v1.htm#effv1_Header_0x2">here</a> for further details.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0003</td>
  <td>1 (char)</td>
  <td><p>Power</p>
</td>
</tr>



<tr>










  <td>0x0004</td>
  <td>4 (dword)</td>
  <td><p>Parameter 1</p>
</td>
</tr>



<tr>










  <td>0x0008</td>
  <td>4 (dword)</td>
  <td><p>Parameter 2</p>
</td>
</tr>



<tr>










  <td>0x000c</td>
  <td>1 (char)</td>
  <td><p><b><a name="V1_Feature_Block_0xC">Timing mode</a></b></p>

<ul>
  <li>0 ⟶ <b><a name="V1_Feature_Block_0xC_0">Instant/Limited</a></b></li>
  <li>1 ⟶ <b><a name="V1_Feature_Block_0xC_1">Instant/Permanent</a></b></li>
  <li>2 ⟶ <b><a name="V1_Feature_Block_0xC_2">Instant/While equipped</a></b></li>
  <li>3 ⟶ <b><a name="V1_Feature_Block_0xC_3">Delay/Limited</a></b></li>
  <li>4 ⟶ <b><a name="V1_Feature_Block_0xC_4">Delay/Permanent</a></b></li>
  <li>5 ⟶ <b><a name="V1_Feature_Block_0xC_5">Delay/While equipped</a></b></li>
  <li>6 ⟶ <b><a name="V1_Feature_Block_0xC_6">Limited after duration</a></b></li>
  <li>7 ⟶ <b><a name="V1_Feature_Block_0xC_7">Permanent after duration</a></b></li>
  <li>8 ⟶ <b><a name="V1_Feature_Block_0xC_8">Equipped after duration</a></b></li>
  <li>9 ⟶ <b><a name="V1_Feature_Block_0xC_9">Instant/Permanent</a></b> (after Death)</li>
  <li>10 ⟶ <b><a name="V1_Feature_Block_0xC_10">Instant/Limited</a></b></li>
  <li>4096 ⟶ <b><a name="V1_Feature_Block_0xC_4096">Absolute duration</a></b></li>
</ul>

<div class="note info">
  <div>
    <strong>Info:</strong> 
See <a href="../ie_formats/eff_v1.htm#effv1_Header_0xC">here</a> for further details.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x000d</td>
  <td>1 (char)</td>
  <td><p><b><a name="V1_Feature_Block_0xD">Dispel / Resistance</a></b></p>

<p>The default behaviour is that effects cannot be dispelled and ignore magic resistance.</p>

<ul>
  <li>bit 0 ⟶ Can be dispelled, affected by magic resistance</li>
  <li>bit 1 ⟶ Ignores magic resistance (when used in combination with bit 0)</li>
</ul>

<p>This can also be presented in the more traditional way:</p>
<ul>
  <li>0 ⟶ Natural/Nonmagical</li>
  <li>1 ⟶ Can be dispelled/Affected by resistance</li>
  <li>2 ⟶ Cannot be dispelled/Ignores resistance</li>
  <li>3 ⟶ Can be dispelled/Ignores resistance</li>
</ul>

<p>The only difference between <code class="language-plaintext highlighter-rouge">0</code> and <code class="language-plaintext highlighter-rouge">2</code> is that <code class="language-plaintext highlighter-rouge">0</code> will automatically convert to <code class="language-plaintext highlighter-rouge">2</code> when targeting yourself.</p>
</td>
</tr>



<tr>










  <td>0x000e</td>
  <td>4 (dword)</td>
  <td><p><b><a name="V1_Feature_Block_0xE">Duration</a></b></p>
</td>
</tr>



<tr>










  <td>0x0012</td>
  <td>1 (char)</td>
  <td><p><b><a name="V1_Feature_Block_0x12">Probability 1</a></b></p>
</td>
</tr>



<tr>










  <td>0x0013</td>
  <td>1 (char)</td>
  <td><p><b><a name="V1_Feature_Block_0x13">Probability 2</a></b></p>

<div class="note info">
  <div>
    <strong>Info:</strong> 
See <a href="../ie_formats/eff_v1.htm#effv1_Header_0x13">here</a> for further details.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0014</td>
  <td>8 (resref)</td>
  <td><p>Resource</p>
</td>
</tr>



<tr>










  <td>0x001c</td>
  <td>4 (dword)</td>
  <td><p><b><a name="V1_Feature_Block_0x1C">Dice Thrown / Maximum Level</a></b></p>

<div class="note info">
  <div>
    <strong>Info:</strong> 
See <a href="../ie_formats/eff_v1.htm#effv1_Header_0x1C">here</a> for further details.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0020</td>
  <td>4 (dword)</td>
  <td><p><b><a name="V1_Feature_Block_0x20">Dice Sides / Minimum Level</a></b></p>

<div class="note info">
  <div>
    <strong>Info:</strong> 
See <a href="../ie_formats/eff_v1.htm#effv1_Header_0x20">here</a> for further details.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0024</td>
  <td>4 (dword)</td>
  <td><p><b><a name="V1_Feature_Block_0x24">Saving throw type</a></b></p>

<ul>
  <li>bit 0 ⟶ <b><a name="V1_Feature_Block_0x24_BIT0">Spells</a></b></li>
  <li>bit 1 ⟶ <b><a name="V1_Feature_Block_0x24_BIT1">Breath</a></b></li>
  <li>bit 2 ⟶ <b><a name="V1_Feature_Block_0x24_BIT2">Paralyze / Poison / Death</a></b></li>
  <li>bit 3 ⟶ <b><a name="V1_Feature_Block_0x24_BIT3">Wands</a></b></li>
  <li>bit 4 ⟶ <b><a name="V1_Feature_Block_0x24_BIT4">Petrify / Polymorph</a></b></li>
  <li>bit 10 ⟶ <b><a name="V1_Feature_Block_0x24_BIT10">Ignore primary target</a></b> (EE only)</li>
  <li>bit 11 ⟶ <b><a name="V1_Feature_Block_0x24_BIT11">Ignore secondary target</a></b> (EE only)</li>
  <li>bit 24 ⟶ <b><a name="V1_Feature_Block_0x24_BIT24">Bypass mirror image</a></b> (EE/TobEx only)</li>
  <li>bit 25 ⟶
    <ul>
      <li><b><a name="V1_Feature_Block_0x24_BIT25_EE">Ignore difficulty</a></b> (EE only)</li>
      <li><b><a name="V1_Feature_Block_0x24_BIT25_ToBEx">Limit effect stacking</a></b> (ToBEx only)</li>
    </ul>
  </li>
  <li>bit 26 ⟶ TobEx internal (don’t use)</li>
</ul>

<div class="note info">
  <div>
    <strong>Info:</strong> 
See <a href="../ie_formats/eff_v1.htm#effv1_Header_0x24">here</a> for further details.

  </div>
</div>
</td>
</tr>



<tr>










  <td>0x0028</td>
  <td>4 (dword)</td>
  <td><p>Saving Throw Bonus</p>
</td>
</tr>



<tr>










  <td>0x002c</td>
  <td>4 (dword)</td>
  <td><p>TobEx: Stacking ID. Checked when bit 25 of the Saving Throw Type is set.</p>

<p>If two effects of the same opcode are applied, both have Limit Effect Stacking bit set, and both have the same stacking ID, then the latter applied effect is suspended in application until the former effect expires. Regardless of whether it is applied, the latter effect will expire at the same time that it would expire if it was applied. In other words, the total duration of some non-stacking effect opcode is not extended because more than one copy of the effect was applied.</p>

<p>Stacking IDs are unique to the opcode being applied. To maintain uniqueness of stacking IDs between different mods, one recommendation is to use the higher word of Special as the modder’s Infinity Engine Community Prefix, then use the lower word as an identifying ID. For example, 0x41360001 (‘A6’ 0x0001).</p>
</td>
</tr>




    </tbody>
  </table>
</div>
<br />


    <hr />
    <br />
    <a id="Header_Flags"><div class="actionheader"> Header Flags </a></div>
    <br />
    <div class="indent1">
    <table border="1" width="98%">
      <colgroup>
        <col width="20%">
        <col width="20%">
        <col width="20%">
        <col class="col4" width="20%">
        <col class="col4" width="20%">
      </colgroup>
      <thead>
        <tr>
          <th>Bit </th>
          <th>Byte 1</th>
          <th>Byte 2</th>
          <th>Byte 3</th>
          <th>Byte 4</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>0</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> <span class="unknown"> Unknown </span></td>
          <td><b><a name="Header_Flags_BIT16">Not in combat</a></b></td>
          <td><b><a name="Header_Flags_BIT24">Can target invisible</a></b> (BGEE, TobEx)</td>
        </tr>
        <tr>
          <td>1</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> Breaks Sanctuary (BGEE) </td>
          <td> <span class="unknown"> Unknown </span></td>
          <td><b><a name="Header_Flags_BIT25">Castable when silenced</a></b> (BGEE, TobEx)</td>
        </tr>
        <tr>
          <td>2</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td><b><a name="Header_Flags_BIT10">Hostile / Breaks Invisibility</a></b></td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> <span class="unknown"> Unknown </span></td>
        </tr>
        <tr>
          <td>3</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> No LOS required</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> <span class="unknown"> Unknown </span></td>
        </tr>
        <tr>
          <td>4</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> <span class="unknown"> Allow spotting </span></td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> <span class="unknown"> Unknown </span></td>
        </tr>
        <tr>
          <td>5</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td><b><a name="Header_Flags_BIT13">Outdoors only</a></b></td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> <span class="unknown"> Unknown </span></td>
        </tr>
        <tr>
          <td>6</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td><b><a name="Header_Flags_BIT14">Ignore dead-magic and wild surge effect</a></b></td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> <span class="unknown"> Unknown </span></td>
        </tr>
        <tr>
          <td>7</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td><b><a name="Header_Flags_BIT15">Ignore wild surge effect</a></b> (i.e. trigger/contingency)</td>
          <td> <span class="unknown"> Unknown </span></td>
          <td> <span class="unknown"> Unknown </span></td>
        </tr>
      </tbody>
    </table>
    </div>
    <br />
    <a id="Exclusion_Flags"><div class="actionheader"> Exclusion Flags</a></div>
    <br />
    <div class="indent1">
    bit 0: Exclude Chaotic priests. (BG2 & HoW)<br />
    bit 1: Exclude Evil priests. (BG2 & HoW)<br />
    bit 2: Exclude Good priests. (BG2 & HoW)<br />
    bit 3: Exclude GENeutral priests. (BG2 & HoW)<br />
    bit 4: Exclude Lawful priests. (BG2 & HoW)<br />
    bit 5: Exclude LCNeutral priests. (BG2 & HoW)<br />
    bit 6: Exclude Abjurers<br />
    bit 7: Exclude Conjurers<br />
    bit 8: Exclude Diviners<br />
    bit 9: Exclude Enchanters<br />
    bit 10: Exclude Illusionists<br />
    bit 11: Exclude Invokers<br />
    bit 12: Exclude Necromancers<br />
    bit 13: Exclude Transmuters<br />
    bit 14: Wild Magic (exclude Generalists) (BG2)<br />
    bit 15 - 29: Unused<br />
    bit 30: Exclude Cleric/Paladin<br />
    bit 31: Exclude Druid/Ranger<br />
    <br />
    NB.Alignment and School exclusion bits cannot be combined.<br />
    </div>
    <br />
    <a id="Header_Casting_Graphics"><div class="actionheader"> Casting Graphics</a></div>
    <br />
    <strong>BG1,BG2,IWD</strong><br />
    <div class="indent1">
    00<br />
    &nbsp;&nbsp;&nbsp;&nbsp;...No animation<br />
    08<br />
    09 Necromancy<br />
    10 Alteration<br />
    11 Enchantment<br />
    12 Abjuration<br />
    13 Illusion<br />
    14 Conjuration<br />
    15 Invocation<br />
    16 Divination<br />
    17 White sparks<br />
    18 Black sparks<br />
    19 White sparks<br />
    20 White sparks<br />
    21 White sparks<br />
    22 White -> red sparks<br />
    23 White -> purple/red sparks<br />
    24 White -> red sparks<br />
    26 White sparks<br />
    32 White sparks<br />
    34 White sparks<br />
    56461 No animation<br />
    65535 No animation<br />
    <br />
    NB. The 'spark' entries are related to sprklclr.2da (and probably opcode #41)<br />
    </div>
    <br />
    <strong>PST</strong><br />
    <div class="indent1">
    35: Abjuration<br />
    36: Alteration<br />
    37: Conjuration<br />
    38: Enchantment<br />
    39: Divination<br />
    40: Illusion<br />
    41: Invocation<br />
    42: Necromancy<br />
    44: Special (Innate) Skill<br />
    </div>
  </div>
</div>


<a href="#" class="go-up">
  &nbsp;
</a>


  </div>
</div>

<script>
window.addEventListener("scroll", function(event) {
  var top = window.pageYOffset || document.documentElement.scrollTop;
  var arrow = document.getElementsByClassName("go-up")[0];
  if (top > 100) {
    arrow.style.visibility = "visible";
  } else {
    arrow.style.visibility = "hidden";
  }
});
</script>

<footer class="site-footer">
  <hr />
  <div id="footer">

    <div class="">
      <a class="gh-icon-container" href="https://github.com/gibberlings3/iesdp/">
  <span class="icon icon--github"><svg viewBox="0 0 16 16"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span>
</a>

      <a href="https://github.com/gibberlings3/iesdp//blob/master/file_formats/ie_formats/spl_v1.htm">Edit this page</a>
    </div>

    <div class="">
      <form method="get" action="http://www.google.com/search">
        <div style="margin: 0px; padding: 0px; text-align: center">
          <input type="hidden" name="ie" value="UTF-8" />
          <input type="hidden" name="oe" value="UTF-8" />
          <input class="form_text" type="text" name="q" size="30" maxlength="255" value="" />
          <input class="form_button" type="submit" name="btnG" value="Search" />
          <input type="hidden" name="domains" value="https://gibberlings3.github.io/iesdp" />
          <input type="hidden" name="sitesearch" value="https://gibberlings3.github.io/iesdp" />
        </div>
      </form>
    </div>

  </div>
  <hr />
</footer>


</body>
</html>
